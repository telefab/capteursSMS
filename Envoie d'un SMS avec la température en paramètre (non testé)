int led = 13;
int onModulePin = 2;        // the pin to switch on the module (without press on button) 
char phone_number[]="+33647877083";     // ********* is the number to call


void switchGSMModule()
{
    digitalWrite(onModulePin,HIGH);
    delay(2100);
    digitalWrite(onModulePin,LOW);
}


void setup()
{
    Serial.begin(115200);                // UART baud rate
    delay(2100);
    pinMode(led, OUTPUT);
    pinMode(onModulePin, OUTPUT);
}


void envoyerUnMessage(float temperature)
{

        switchGSMModule();                    // switches the GSM module ON
        delay(2500);
        Serial.println("AT+CMGF=1");         // sets the SMS mode to text
        delay(1600);
        
        Serial.print("AT+CMGS=\"");     // send the SMS number
        Serial.print(phone_number);
        Serial.print("\"\r\n");
        while(Serial.read()!='>');  

        Serial.print("Attention, le seuil critique de température dans le capteur 1 a été atteint. La température y est de ");     // the SMS body
        Serial.print(temperature, 2);
        Serial.print(" degrés celsius.");           // Fin SMS body

        delay(500);
        Serial.write(0x1A);       //sends ++
        Serial.write(0x0D);
        Serial.write(0x0A);
        delay(5000);
        switchGSMModule();       // switch OFF module GSM
}


void loop()
{
    float temperature = 1.0;
    envoyerUnMessage(temperature);
    
    delay(100000000);
}
